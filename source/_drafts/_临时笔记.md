echo delete files before 60 days

forfiles /p "E:\backup\db" /m *.sql /d -60 /c "cmd /c del @file /f"

echo /dev/xdb1 /home ext3 defaults 0 0 >> /etc/fstab


mysql57-community-release-el7-9.noarch.rpm

wget http://repo.mysql.com/mysql57-community-release-el7-9.noarch.rpm
yum -y localinstall mysql57-community-release-el7-9.noarch.rpm
yum -y install mysql-community-server


alter user 'root'@'localhost' identified by 'Yydzw@2016!';


https://docs.mongodb.com/manual/tutorial/install-mongodb-on-red-hat/

sudo vim /etc/yum.repos.d/mongodb-org-3.4.repo

[mongodb-org-3.4]
name=MongoDB Repository
baseurl=https://repo.mongodb.org/yum/redhat/$releasever/mongodb-org/3.4/x86_64/
gpgcheck=1
enabled=1
gpgkey=https://www.mongodb.org/static/pgp/server-3.4.asc

配置 SELinux， 有三种选择

- 在文件 /etc/selinux/config 设置 SELINUX=disabled
- 在文件 /etc/selinux/config 设置 SELINUX=permissive
- 如果 SELINUX=enforcing ， 执行 `semanage port -a -t mongod_port_t -p tcp 27017` ， 27017为默认端口号

设置完成后需要重启系统

安装 
sudo yum install -y mongodb-org

通过 systemd 管理 mongod

systemctl [start | stop | restart | status] mongod 



-------------------

let's encrypt 

https://my.oschina.net/diamondfsd/blog/829503

安装Certbot客户端
yum install certbot



获取证书
certbot certonly --webroot -w /home/www/html -d gobeta.net -d www.gobeta.net












server {
    listen 443 ssl http2;
    listen [::]:443 ssl http2;
    server_name gobeta.net www.gobeta.net;

    ssl on;
    ssl_certificate /etc/letsencrypt/live/gobeta.net/fullchain.pem;
    ssl_certificate_key /etc/letsencrypt/live/gobeta.net/privkey.pem;
    
    if ($host != 'gobeta.net') {
        rewrite ^(.*)$ https://gobeta.net$1 permanent;
    }

    location / {
        root   /home/www/html;
        index  index.html index.htm;
    }
}


https://mozilla.github.io/server-side-tls/ssl-config-generator/
	


## mongodb

use admin

db.createUser({
    user: "superadmin",
    pwd: "yydzw@2016",
    roles: [
        { role: "userAdminAnyDatabase", db: "admin"}
    ]
})

use btw

db.createUser({
    user: "btw",
    pwd: "btw2016",
    roles: [
        { role: "readWrite", db: "btw"}
    ]
})





 http://download.oracle.com/otn-pub/java/jdk/8u121-b13/e9e7ea248e2c4826b92b3f075a80e441/server-jre-8u121-linux-x64.tar.gz


 wget --no-cookies --no-check-certificate --header "Cookie: gpw_e24=http%3A%2F%2Fwww.oracle.com%2F; oraclelicense=accept-securebackup-cookie" "http://download.oracle.com/otn-pub/java/jdk/8u121-b13/e9e7ea248e2c4826b92b3f075a80e441/server-jre-8u121-linux-x64.tar.gz"



jdk1.8.0_121 


#!/bin/bash
JAVA_HOME=/opt/jdk1.8.0_121
PATH=$JAVA_HOME/bin:$PATH
export PATH JAVA_HOME
export CLASSPATH=.







server {
    listen       80;
    listen       [::]:80;
    server_name  gobeta.net www.gobeta.net;

    # return 301 https://$host$request_uri;
    rewrite ^(.*)$ https://gobeta.net$1 permanent;
}

server {
    listen 443 ssl http2;
    listen [::]:443 ssl http2;
    server_name gobeta.net www.gobeta.net;
    
    ssl on;
    ssl_certificate /etc/letsencrypt/live/gobeta.net/fullchain.pem;
    ssl_certificate_key /etc/letsencrypt/live/gobeta.net/privkey.pem;

    if ($host != 'gobeta.net') {
        rewrite ^(.*)$ https://gobeta.net$1 permanent;
    }

    location / {
        root   /home/www/html;
        index  index.html index.htm;
    }
}


server {
    listen       80;
    server_name  api.gobeta.net;
   
    location  / {
        proxy_pass         http://127.0.0.1:8888;
        proxy_set_header   Host             $host;
        proxy_set_header   X-Real-IP        $remote_addr;
        proxy_set_header   X-Forwarded-For  $proxy_add_x_forwarded_for;
        proxy_buffering                     off;  
        chunked_transfer_encoding           on;
        client_max_body_size                100m;
    }
}
